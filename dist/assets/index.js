import*as K from"three";import{Ray as be,Plane as xe,MathUtils as _e,Vector3 as it,Controls as Ce,MOUSE as Mt,TOUCH as wt,Quaternion as ie,Spherical as oe,Vector2 as R,OrthographicCamera as we,Mesh as Te,BufferGeometry as le,Float32BufferAttribute as At,ShaderMaterial as Tt,UniformsUtils as Xt,WebGLRenderTarget as Ft,HalfFloatType as Gt,NoBlending as Me,Clock as Se,Color as Wt,AdditiveBlending as Pe,MeshBasicMaterial as ve,Loader as Ee,FileLoader as Ae,Matrix3 as _t,ShapeUtils as De,Box2 as Re,Shape as ke,Path as qt,ShapePath as yt,SRGBColorSpace as Le}from"three";import{GUI as Ie}from"dat.gui";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))c(h);new MutationObserver(h=>{for(const l of h)if(l.type==="childList")for(const _ of l.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&c(_)}).observe(document,{childList:!0,subtree:!0});function a(h){const l={};return h.integrity&&(l.integrity=h.integrity),h.referrerPolicy&&(l.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?l.credentials="include":h.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(h){if(h.ep)return;h.ep=!0;const l=a(h);fetch(h.href,l)}})();const ne={type:"change"},Qt={type:"start"},he={type:"end"},Ut=new be,ae=new xe,Oe=Math.cos(70*_e.DEG2RAD),st=new it,lt=2*Math.PI,W={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Kt=1e-6;class Ne extends Ce{constructor(t,a=null){super(t,a),this.state=W.NONE,this.enabled=!0,this.target=new it,this.cursor=new it,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Mt.ROTATE,MIDDLE:Mt.DOLLY,RIGHT:Mt.PAN},this.touches={ONE:wt.ROTATE,TWO:wt.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new it,this._lastQuaternion=new ie,this._lastTargetPosition=new it,this._quat=new ie().setFromUnitVectors(t.up,new it(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new oe,this._sphericalDelta=new oe,this._scale=1,this._panOffset=new it,this._rotateStart=new R,this._rotateEnd=new R,this._rotateDelta=new R,this._panStart=new R,this._panEnd=new R,this._panDelta=new R,this._dollyStart=new R,this._dollyEnd=new R,this._dollyDelta=new R,this._dollyDirection=new it,this._mouse=new R,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Ue.bind(this),this._onPointerDown=je.bind(this),this._onPointerUp=ze.bind(this),this._onContextMenu=Ye.bind(this),this._onMouseWheel=Ve.bind(this),this._onKeyDown=Fe.bind(this),this._onTouchStart=Ge.bind(this),this._onTouchMove=We.bind(this),this._onMouseDown=Be.bind(this),this._onMouseMove=He.bind(this),this._interceptControlDown=Ze.bind(this),this._interceptControlUp=qe.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(ne),this.update(),this.state=W.NONE}update(t=null){const a=this.object.position;st.copy(a).sub(this.target),st.applyQuaternion(this._quat),this._spherical.setFromVector3(st),this.autoRotate&&this.state===W.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let c=this.minAzimuthAngle,h=this.maxAzimuthAngle;isFinite(c)&&isFinite(h)&&(c<-Math.PI?c+=lt:c>Math.PI&&(c-=lt),h<-Math.PI?h+=lt:h>Math.PI&&(h-=lt),c<=h?this._spherical.theta=Math.max(c,Math.min(h,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(c+h)/2?Math.max(c,this._spherical.theta):Math.min(h,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let l=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const _=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),l=_!=this._spherical.radius}if(st.setFromSpherical(this._spherical),st.applyQuaternion(this._quatInverse),a.copy(this.target).add(st),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let _=null;if(this.object.isPerspectiveCamera){const U=st.length();_=this._clampDistance(U*this._scale);const N=U-_;this.object.position.addScaledVector(this._dollyDirection,N),this.object.updateMatrixWorld(),l=!!N}else if(this.object.isOrthographicCamera){const U=new it(this._mouse.x,this._mouse.y,0);U.unproject(this.object);const N=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),l=N!==this.object.zoom;const X=new it(this._mouse.x,this._mouse.y,0);X.unproject(this.object),this.object.position.sub(X).add(U),this.object.updateMatrixWorld(),_=st.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;_!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(_).add(this.object.position):(Ut.origin.copy(this.object.position),Ut.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Ut.direction))<Oe?this.object.lookAt(this.target):(ae.setFromNormalAndCoplanarPoint(this.object.up,this.target),Ut.intersectPlane(ae,this.target))))}else if(this.object.isOrthographicCamera){const _=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),_!==this.object.zoom&&(this.object.updateProjectionMatrix(),l=!0)}return this._scale=1,this._performCursorZoom=!1,l||this._lastPosition.distanceToSquared(this.object.position)>Kt||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Kt||this._lastTargetPosition.distanceToSquared(this.target)>Kt?(this.dispatchEvent(ne),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?lt/60*this.autoRotateSpeed*t:lt/60/60*this.autoRotateSpeed}_getZoomScale(t){const a=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*a)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,a){st.setFromMatrixColumn(a,0),st.multiplyScalar(-t),this._panOffset.add(st)}_panUp(t,a){this.screenSpacePanning===!0?st.setFromMatrixColumn(a,1):(st.setFromMatrixColumn(a,0),st.crossVectors(this.object.up,st)),st.multiplyScalar(t),this._panOffset.add(st)}_pan(t,a){const c=this.domElement;if(this.object.isPerspectiveCamera){const h=this.object.position;st.copy(h).sub(this.target);let l=st.length();l*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*l/c.clientHeight,this.object.matrix),this._panUp(2*a*l/c.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/c.clientWidth,this.object.matrix),this._panUp(a*(this.object.top-this.object.bottom)/this.object.zoom/c.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,a){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const c=this.domElement.getBoundingClientRect(),h=t-c.left,l=a-c.top,_=c.width,U=c.height;this._mouse.x=h/_*2-1,this._mouse.y=-(l/U)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const a=this.domElement;this._rotateLeft(lt*this._rotateDelta.x/a.clientHeight),this._rotateUp(lt*this._rotateDelta.y/a.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let a=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateUp(lt*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),a=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateUp(-lt*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),a=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateLeft(lt*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),a=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this._rotateLeft(-lt*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),a=!0;break}a&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const a=this._getSecondPointerPosition(t),c=.5*(t.pageX+a.x),h=.5*(t.pageY+a.y);this._rotateStart.set(c,h)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const a=this._getSecondPointerPosition(t),c=.5*(t.pageX+a.x),h=.5*(t.pageY+a.y);this._panStart.set(c,h)}}_handleTouchStartDolly(t){const a=this._getSecondPointerPosition(t),c=t.pageX-a.x,h=t.pageY-a.y,l=Math.sqrt(c*c+h*h);this._dollyStart.set(0,l)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const c=this._getSecondPointerPosition(t),h=.5*(t.pageX+c.x),l=.5*(t.pageY+c.y);this._rotateEnd.set(h,l)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const a=this.domElement;this._rotateLeft(lt*this._rotateDelta.x/a.clientHeight),this._rotateUp(lt*this._rotateDelta.y/a.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const a=this._getSecondPointerPosition(t),c=.5*(t.pageX+a.x),h=.5*(t.pageY+a.y);this._panEnd.set(c,h)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const a=this._getSecondPointerPosition(t),c=t.pageX-a.x,h=t.pageY-a.y,l=Math.sqrt(c*c+h*h);this._dollyEnd.set(0,l),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const _=(t.pageX+a.x)*.5,U=(t.pageY+a.y)*.5;this._updateZoomParameters(_,U)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let a=0;a<this._pointers.length;a++)if(this._pointers[a]==t.pointerId){this._pointers.splice(a,1);return}}_isTrackingPointer(t){for(let a=0;a<this._pointers.length;a++)if(this._pointers[a]==t.pointerId)return!0;return!1}_trackPointer(t){let a=this._pointerPositions[t.pointerId];a===void 0&&(a=new R,this._pointerPositions[t.pointerId]=a),a.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const a=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[a]}_customWheelEvent(t){const a=t.deltaMode,c={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(a){case 1:c.deltaY*=16;break;case 2:c.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(c.deltaY*=10),c}}function je(f){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(f.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(f)&&(this._addPointer(f),f.pointerType==="touch"?this._onTouchStart(f):this._onMouseDown(f)))}function Ue(f){this.enabled!==!1&&(f.pointerType==="touch"?this._onTouchMove(f):this._onMouseMove(f))}function ze(f){switch(this._removePointer(f),this._pointers.length){case 0:this.domElement.releasePointerCapture(f.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(he),this.state=W.NONE;break;case 1:const t=this._pointers[0],a=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:a.x,pageY:a.y});break}}function Be(f){let t;switch(f.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Mt.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(f),this.state=W.DOLLY;break;case Mt.ROTATE:if(f.ctrlKey||f.metaKey||f.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(f),this.state=W.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(f),this.state=W.ROTATE}break;case Mt.PAN:if(f.ctrlKey||f.metaKey||f.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(f),this.state=W.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(f),this.state=W.PAN}break;default:this.state=W.NONE}this.state!==W.NONE&&this.dispatchEvent(Qt)}function He(f){switch(this.state){case W.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(f);break;case W.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(f);break;case W.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(f);break}}function Ve(f){this.enabled===!1||this.enableZoom===!1||this.state!==W.NONE||(f.preventDefault(),this.dispatchEvent(Qt),this._handleMouseWheel(this._customWheelEvent(f)),this.dispatchEvent(he))}function Fe(f){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(f)}function Ge(f){switch(this._trackPointer(f),this._pointers.length){case 1:switch(this.touches.ONE){case wt.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(f),this.state=W.TOUCH_ROTATE;break;case wt.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(f),this.state=W.TOUCH_PAN;break;default:this.state=W.NONE}break;case 2:switch(this.touches.TWO){case wt.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(f),this.state=W.TOUCH_DOLLY_PAN;break;case wt.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(f),this.state=W.TOUCH_DOLLY_ROTATE;break;default:this.state=W.NONE}break;default:this.state=W.NONE}this.state!==W.NONE&&this.dispatchEvent(Qt)}function We(f){switch(this._trackPointer(f),this.state){case W.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(f),this.update();break;case W.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(f),this.update();break;case W.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(f),this.update();break;case W.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(f),this.update();break;default:this.state=W.NONE}}function Ye(f){this.enabled!==!1&&f.preventDefault()}function Ze(f){f.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function qe(f){f.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const ce={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class Rt{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Ke=new we(-1,1,1,-1,0,1);class Xe extends le{constructor(){super(),this.setAttribute("position",new At([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new At([0,2,0,0,2,0],2))}}const Qe=new Xe;class ue{constructor(t){this._mesh=new Te(Qe,t)}dispose(){this._mesh.geometry.dispose()}render(t){t.render(this._mesh,Ke)}get material(){return this._mesh.material}set material(t){this._mesh.material=t}}class Jt extends Rt{constructor(t,a){super(),this.textureID=a!==void 0?a:"tDiffuse",t instanceof Tt?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=Xt.clone(t.uniforms),this.material=new Tt({name:t.name!==void 0?t.name:"unspecified",defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new ue(this.material)}render(t,a,c){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(a),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class re extends Rt{constructor(t,a){super(),this.scene=t,this.camera=a,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(t,a,c){const h=t.getContext(),l=t.state;l.buffers.color.setMask(!1),l.buffers.depth.setMask(!1),l.buffers.color.setLocked(!0),l.buffers.depth.setLocked(!0);let _,U;this.inverse?(_=0,U=1):(_=1,U=0),l.buffers.stencil.setTest(!0),l.buffers.stencil.setOp(h.REPLACE,h.REPLACE,h.REPLACE),l.buffers.stencil.setFunc(h.ALWAYS,_,4294967295),l.buffers.stencil.setClear(U),l.buffers.stencil.setLocked(!0),t.setRenderTarget(c),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(a),this.clear&&t.clear(),t.render(this.scene,this.camera),l.buffers.color.setLocked(!1),l.buffers.depth.setLocked(!1),l.buffers.color.setMask(!0),l.buffers.depth.setMask(!0),l.buffers.stencil.setLocked(!1),l.buffers.stencil.setFunc(h.EQUAL,1,4294967295),l.buffers.stencil.setOp(h.KEEP,h.KEEP,h.KEEP),l.buffers.stencil.setLocked(!0)}}class Je extends Rt{constructor(){super(),this.needsSwap=!1}render(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}class $e{constructor(t,a){if(this.renderer=t,this._pixelRatio=t.getPixelRatio(),a===void 0){const c=t.getSize(new R);this._width=c.width,this._height=c.height,a=new Ft(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Gt}),a.texture.name="EffectComposer.rt1"}else this._width=a.width,this._height=a.height;this.renderTarget1=a,this.renderTarget2=a.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Jt(ce),this.copyPass.material.blending=Me,this.clock=new Se}swapBuffers(){const t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}addPass(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(t,a){this.passes.splice(a,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(t){const a=this.passes.indexOf(t);a!==-1&&this.passes.splice(a,1)}isLastEnabledPass(t){for(let a=t+1;a<this.passes.length;a++)if(this.passes[a].enabled)return!1;return!0}render(t){t===void 0&&(t=this.clock.getDelta());const a=this.renderer.getRenderTarget();let c=!1;for(let h=0,l=this.passes.length;h<l;h++){const _=this.passes[h];if(_.enabled!==!1){if(_.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(h),_.render(this.renderer,this.writeBuffer,this.readBuffer,t,c),_.needsSwap){if(c){const U=this.renderer.getContext(),N=this.renderer.state.buffers.stencil;N.setFunc(U.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),N.setFunc(U.EQUAL,1,4294967295)}this.swapBuffers()}re!==void 0&&(_ instanceof re?c=!0:_ instanceof Je&&(c=!1))}}this.renderer.setRenderTarget(a)}reset(t){if(t===void 0){const a=this.renderer.getSize(new R);this._pixelRatio=this.renderer.getPixelRatio(),this._width=a.width,this._height=a.height,t=this.renderTarget1.clone(),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(t,a){this._width=t,this._height=a;const c=this._width*this._pixelRatio,h=this._height*this._pixelRatio;this.renderTarget1.setSize(c,h),this.renderTarget2.setSize(c,h);for(let l=0;l<this.passes.length;l++)this.passes[l].setSize(c,h)}setPixelRatio(t){this._pixelRatio=t,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class ts extends Rt{constructor(t,a,c=null,h=null,l=null){super(),this.scene=t,this.camera=a,this.overrideMaterial=c,this.clearColor=h,this.clearAlpha=l,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Wt}render(t,a,c){const h=t.autoClear;t.autoClear=!1;let l,_;this.overrideMaterial!==null&&(_=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(t.getClearColor(this._oldClearColor),t.setClearColor(this.clearColor,t.getClearAlpha())),this.clearAlpha!==null&&(l=t.getClearAlpha(),t.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:c),this.clear===!0&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor!==null&&t.setClearColor(this._oldClearColor),this.clearAlpha!==null&&t.setClearAlpha(l),this.overrideMaterial!==null&&(this.scene.overrideMaterial=_),t.autoClear=h}}const es={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Wt(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			float v = luminance( texel.xyz );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class St extends Rt{constructor(t,a,c,h){super(),this.strength=a!==void 0?a:1,this.radius=c,this.threshold=h,this.resolution=t!==void 0?new R(t.x,t.y):new R(256,256),this.clearColor=new Wt(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let l=Math.round(this.resolution.x/2),_=Math.round(this.resolution.y/2);this.renderTargetBright=new Ft(l,_,{type:Gt}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let I=0;I<this.nMips;I++){const B=new Ft(l,_,{type:Gt});B.texture.name="UnrealBloomPass.h"+I,B.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(B);const ht=new Ft(l,_,{type:Gt});ht.texture.name="UnrealBloomPass.v"+I,ht.texture.generateMipmaps=!1,this.renderTargetsVertical.push(ht),l=Math.round(l/2),_=Math.round(_/2)}const U=es;this.highPassUniforms=Xt.clone(U.uniforms),this.highPassUniforms.luminosityThreshold.value=h,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Tt({uniforms:this.highPassUniforms,vertexShader:U.vertexShader,fragmentShader:U.fragmentShader}),this.separableBlurMaterials=[];const N=[3,5,7,9,11];l=Math.round(this.resolution.x/2),_=Math.round(this.resolution.y/2);for(let I=0;I<this.nMips;I++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(N[I])),this.separableBlurMaterials[I].uniforms.invSize.value=new R(1/l,1/_),l=Math.round(l/2),_=Math.round(_/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=a,this.compositeMaterial.uniforms.bloomRadius.value=.1;const X=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=X,this.bloomTintColors=[new it(1,1,1),new it(1,1,1),new it(1,1,1),new it(1,1,1),new it(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const tt=ce;this.copyUniforms=Xt.clone(tt.uniforms),this.blendMaterial=new Tt({uniforms:this.copyUniforms,vertexShader:tt.vertexShader,fragmentShader:tt.fragmentShader,blending:Pe,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Wt,this.oldClearAlpha=1,this.basic=new ve,this.fsQuad=new ue(null)}dispose(){for(let t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(let t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose();for(let t=0;t<this.separableBlurMaterials.length;t++)this.separableBlurMaterials[t].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(t,a){let c=Math.round(t/2),h=Math.round(a/2);this.renderTargetBright.setSize(c,h);for(let l=0;l<this.nMips;l++)this.renderTargetsHorizontal[l].setSize(c,h),this.renderTargetsVertical[l].setSize(c,h),this.separableBlurMaterials[l].uniforms.invSize.value=new R(1/c,1/h),c=Math.round(c/2),h=Math.round(h/2)}render(t,a,c,h,l){t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();const _=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),l&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=c.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=c.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t);let U=this.renderTargetBright;for(let N=0;N<this.nMips;N++)this.fsQuad.material=this.separableBlurMaterials[N],this.separableBlurMaterials[N].uniforms.colorTexture.value=U.texture,this.separableBlurMaterials[N].uniforms.direction.value=St.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[N]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[N].uniforms.colorTexture.value=this.renderTargetsHorizontal[N].texture,this.separableBlurMaterials[N].uniforms.direction.value=St.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[N]),t.clear(),this.fsQuad.render(t),U=this.renderTargetsVertical[N];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,l&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(c),this.fsQuad.render(t)),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=_}getSeperableBlurMaterial(t){const a=[];for(let c=0;c<t;c++)a.push(.39894*Math.exp(-.5*c*c/(t*t))/t);return new Tt({defines:{KERNEL_RADIUS:t},uniforms:{colorTexture:{value:null},invSize:{value:new R(.5,.5)},direction:{value:new R(.5,.5)},gaussianCoefficients:{value:a}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(t){return new Tt({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}St.BlurDirectionX=new R(1,0);St.BlurDirectionY=new R(0,1);const ss=Le;class $t extends Ee{constructor(t){super(t),this.defaultDPI=90,this.defaultUnit="px"}load(t,a,c,h){const l=this,_=new Ae(l.manager);_.setPath(l.path),_.setRequestHeader(l.requestHeader),_.setWithCredentials(l.withCredentials),_.load(t,function(U){try{a(l.parse(U))}catch(N){h?h(N):console.error(N),l.manager.itemError(t)}},c,h)}parse(t){const a=this;function c(r,o){if(r.nodeType!==1)return;const s=A(r);let e=!1,d=null;switch(r.nodeName){case"svg":o=Q(r,o);break;case"style":l(r);break;case"g":o=Q(r,o);break;case"path":o=Q(r,o),r.hasAttribute("d")&&(d=h(r));break;case"rect":o=Q(r,o),d=N(r);break;case"polygon":o=Q(r,o),d=X(r);break;case"polyline":o=Q(r,o),d=tt(r);break;case"circle":o=Q(r,o),d=I(r);break;case"ellipse":o=Q(r,o),d=B(r);break;case"line":o=Q(r,o),d=ht(r);break;case"defs":e=!0;break;case"use":o=Q(r,o);const x=(r.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),w=r.viewportElement.getElementById(x);w?c(w,o):console.warn("SVGLoader: 'use node' references non-existent node id: "+x);break}d&&(o.fill!==void 0&&o.fill!=="none"&&d.color.setStyle(o.fill,ss),j(d,ut),D.push(d),d.userData={node:r,style:o});const y=r.childNodes;for(let u=0;u<y.length;u++){const x=y[u];e&&x.nodeName!=="style"&&x.nodeName!=="defs"||c(x,o)}s&&(q.pop(),q.length>0?ut.copy(q[q.length-1]):ut.identity())}function h(r){const o=new yt,s=new R,e=new R,d=new R;let y=!0,u=!1;const x=r.getAttribute("d");if(x===""||x==="none")return null;const w=x.match(/[a-df-z][^a-df-z]*/ig);for(let T=0,p=w.length;T<p;T++){const m=w[T],M=m.charAt(0),v=m.slice(1).trim();y===!0&&(u=!0,y=!1);let n;switch(M){case"M":n=C(v);for(let i=0,E=n.length;i<E;i+=2)s.x=n[i+0],s.y=n[i+1],e.x=s.x,e.y=s.y,i===0?o.moveTo(s.x,s.y):o.lineTo(s.x,s.y),i===0&&d.copy(s);break;case"H":n=C(v);for(let i=0,E=n.length;i<E;i++)s.x=n[i],e.x=s.x,e.y=s.y,o.lineTo(s.x,s.y),i===0&&u===!0&&d.copy(s);break;case"V":n=C(v);for(let i=0,E=n.length;i<E;i++)s.y=n[i],e.x=s.x,e.y=s.y,o.lineTo(s.x,s.y),i===0&&u===!0&&d.copy(s);break;case"L":n=C(v);for(let i=0,E=n.length;i<E;i+=2)s.x=n[i+0],s.y=n[i+1],e.x=s.x,e.y=s.y,o.lineTo(s.x,s.y),i===0&&u===!0&&d.copy(s);break;case"C":n=C(v);for(let i=0,E=n.length;i<E;i+=6)o.bezierCurveTo(n[i+0],n[i+1],n[i+2],n[i+3],n[i+4],n[i+5]),e.x=n[i+2],e.y=n[i+3],s.x=n[i+4],s.y=n[i+5],i===0&&u===!0&&d.copy(s);break;case"S":n=C(v);for(let i=0,E=n.length;i<E;i+=4)o.bezierCurveTo(P(s.x,e.x),P(s.y,e.y),n[i+0],n[i+1],n[i+2],n[i+3]),e.x=n[i+0],e.y=n[i+1],s.x=n[i+2],s.y=n[i+3],i===0&&u===!0&&d.copy(s);break;case"Q":n=C(v);for(let i=0,E=n.length;i<E;i+=4)o.quadraticCurveTo(n[i+0],n[i+1],n[i+2],n[i+3]),e.x=n[i+0],e.y=n[i+1],s.x=n[i+2],s.y=n[i+3],i===0&&u===!0&&d.copy(s);break;case"T":n=C(v);for(let i=0,E=n.length;i<E;i+=2){const G=P(s.x,e.x),ct=P(s.y,e.y);o.quadraticCurveTo(G,ct,n[i+0],n[i+1]),e.x=G,e.y=ct,s.x=n[i+0],s.y=n[i+1],i===0&&u===!0&&d.copy(s)}break;case"A":n=C(v,[3,4],7);for(let i=0,E=n.length;i<E;i+=7){if(n[i+5]==s.x&&n[i+6]==s.y)continue;const G=s.clone();s.x=n[i+5],s.y=n[i+6],e.x=s.x,e.y=s.y,_(o,n[i],n[i+1],n[i+2],n[i+3],n[i+4],G,s),i===0&&u===!0&&d.copy(s)}break;case"m":n=C(v);for(let i=0,E=n.length;i<E;i+=2)s.x+=n[i+0],s.y+=n[i+1],e.x=s.x,e.y=s.y,i===0?o.moveTo(s.x,s.y):o.lineTo(s.x,s.y),i===0&&d.copy(s);break;case"h":n=C(v);for(let i=0,E=n.length;i<E;i++)s.x+=n[i],e.x=s.x,e.y=s.y,o.lineTo(s.x,s.y),i===0&&u===!0&&d.copy(s);break;case"v":n=C(v);for(let i=0,E=n.length;i<E;i++)s.y+=n[i],e.x=s.x,e.y=s.y,o.lineTo(s.x,s.y),i===0&&u===!0&&d.copy(s);break;case"l":n=C(v);for(let i=0,E=n.length;i<E;i+=2)s.x+=n[i+0],s.y+=n[i+1],e.x=s.x,e.y=s.y,o.lineTo(s.x,s.y),i===0&&u===!0&&d.copy(s);break;case"c":n=C(v);for(let i=0,E=n.length;i<E;i+=6)o.bezierCurveTo(s.x+n[i+0],s.y+n[i+1],s.x+n[i+2],s.y+n[i+3],s.x+n[i+4],s.y+n[i+5]),e.x=s.x+n[i+2],e.y=s.y+n[i+3],s.x+=n[i+4],s.y+=n[i+5],i===0&&u===!0&&d.copy(s);break;case"s":n=C(v);for(let i=0,E=n.length;i<E;i+=4)o.bezierCurveTo(P(s.x,e.x),P(s.y,e.y),s.x+n[i+0],s.y+n[i+1],s.x+n[i+2],s.y+n[i+3]),e.x=s.x+n[i+0],e.y=s.y+n[i+1],s.x+=n[i+2],s.y+=n[i+3],i===0&&u===!0&&d.copy(s);break;case"q":n=C(v);for(let i=0,E=n.length;i<E;i+=4)o.quadraticCurveTo(s.x+n[i+0],s.y+n[i+1],s.x+n[i+2],s.y+n[i+3]),e.x=s.x+n[i+0],e.y=s.y+n[i+1],s.x+=n[i+2],s.y+=n[i+3],i===0&&u===!0&&d.copy(s);break;case"t":n=C(v);for(let i=0,E=n.length;i<E;i+=2){const G=P(s.x,e.x),ct=P(s.y,e.y);o.quadraticCurveTo(G,ct,s.x+n[i+0],s.y+n[i+1]),e.x=G,e.y=ct,s.x=s.x+n[i+0],s.y=s.y+n[i+1],i===0&&u===!0&&d.copy(s)}break;case"a":n=C(v,[3,4],7);for(let i=0,E=n.length;i<E;i+=7){if(n[i+5]==0&&n[i+6]==0)continue;const G=s.clone();s.x+=n[i+5],s.y+=n[i+6],e.x=s.x,e.y=s.y,_(o,n[i],n[i+1],n[i+2],n[i+3],n[i+4],G,s),i===0&&u===!0&&d.copy(s)}break;case"Z":case"z":o.currentPath.autoClose=!0,o.currentPath.curves.length>0&&(s.copy(d),o.currentPath.currentPoint.copy(s),y=!0);break;default:console.warn(m)}u=!1}return o}function l(r){if(!(!r.sheet||!r.sheet.cssRules||!r.sheet.cssRules.length))for(let o=0;o<r.sheet.cssRules.length;o++){const s=r.sheet.cssRules[o];if(s.type!==1)continue;const e=s.selectorText.split(/,/gm).filter(Boolean).map(d=>d.trim());for(let d=0;d<e.length;d++){const y=Object.fromEntries(Object.entries(s.style).filter(([,u])=>u!==""));J[e[d]]=Object.assign(J[e[d]]||{},y)}}}function _(r,o,s,e,d,y,u,x){if(o==0||s==0){r.lineTo(x.x,x.y);return}e=e*Math.PI/180,o=Math.abs(o),s=Math.abs(s);const w=(u.x-x.x)/2,T=(u.y-x.y)/2,p=Math.cos(e)*w+Math.sin(e)*T,m=-Math.sin(e)*w+Math.cos(e)*T;let M=o*o,v=s*s;const n=p*p,i=m*m,E=n/M+i/v;if(E>1){const jt=Math.sqrt(E);o=jt*o,s=jt*s,M=o*o,v=s*s}const G=M*i+v*n,ct=(M*v-G)/G;let dt=Math.sqrt(Math.max(0,ct));d===y&&(dt=-dt);const nt=dt*o*m/s,mt=-dt*s*p/o,Ot=Math.cos(e)*nt-Math.sin(e)*mt+(u.x+x.x)/2,te=Math.sin(e)*nt+Math.cos(e)*mt+(u.y+x.y)/2,Nt=U(1,0,(p-nt)/o,(m-mt)/s),Zt=U((p-nt)/o,(m-mt)/s,(-p-nt)/o,(-m-mt)/s)%(Math.PI*2);r.currentPath.absellipse(Ot,te,o,s,Nt,Nt+Zt,y===0,e)}function U(r,o,s,e){const d=r*s+o*e,y=Math.sqrt(r*r+o*o)*Math.sqrt(s*s+e*e);let u=Math.acos(Math.max(-1,Math.min(1,d/y)));return r*e-o*s<0&&(u=-u),u}function N(r){const o=b(r.getAttribute("x")||0),s=b(r.getAttribute("y")||0),e=b(r.getAttribute("rx")||r.getAttribute("ry")||0),d=b(r.getAttribute("ry")||r.getAttribute("rx")||0),y=b(r.getAttribute("width")),u=b(r.getAttribute("height")),x=1-.551915024494,w=new yt;return w.moveTo(o+e,s),w.lineTo(o+y-e,s),(e!==0||d!==0)&&w.bezierCurveTo(o+y-e*x,s,o+y,s+d*x,o+y,s+d),w.lineTo(o+y,s+u-d),(e!==0||d!==0)&&w.bezierCurveTo(o+y,s+u-d*x,o+y-e*x,s+u,o+y-e,s+u),w.lineTo(o+e,s+u),(e!==0||d!==0)&&w.bezierCurveTo(o+e*x,s+u,o,s+u-d*x,o,s+u-d),w.lineTo(o,s+d),(e!==0||d!==0)&&w.bezierCurveTo(o,s+d*x,o+e*x,s,o+e,s),w}function X(r){function o(y,u,x){const w=b(u),T=b(x);d===0?e.moveTo(w,T):e.lineTo(w,T),d++}const s=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,e=new yt;let d=0;return r.getAttribute("points").replace(s,o),e.currentPath.autoClose=!0,e}function tt(r){function o(y,u,x){const w=b(u),T=b(x);d===0?e.moveTo(w,T):e.lineTo(w,T),d++}const s=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,e=new yt;let d=0;return r.getAttribute("points").replace(s,o),e.currentPath.autoClose=!1,e}function I(r){const o=b(r.getAttribute("cx")||0),s=b(r.getAttribute("cy")||0),e=b(r.getAttribute("r")||0),d=new qt;d.absarc(o,s,e,0,Math.PI*2);const y=new yt;return y.subPaths.push(d),y}function B(r){const o=b(r.getAttribute("cx")||0),s=b(r.getAttribute("cy")||0),e=b(r.getAttribute("rx")||0),d=b(r.getAttribute("ry")||0),y=new qt;y.absellipse(o,s,e,d,0,Math.PI*2);const u=new yt;return u.subPaths.push(y),u}function ht(r){const o=b(r.getAttribute("x1")||0),s=b(r.getAttribute("y1")||0),e=b(r.getAttribute("x2")||0),d=b(r.getAttribute("y2")||0),y=new yt;return y.moveTo(o,s),y.lineTo(e,d),y.currentPath.autoClose=!1,y}function Q(r,o){o=Object.assign({},o);let s={};if(r.hasAttribute("class")){const u=r.getAttribute("class").split(/\s/).filter(Boolean).map(x=>x.trim());for(let x=0;x<u.length;x++)s=Object.assign(s,J["."+u[x]])}r.hasAttribute("id")&&(s=Object.assign(s,J["#"+r.getAttribute("id")]));function e(u,x,w){w===void 0&&(w=function(p){return p.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),p}),r.hasAttribute(u)&&(o[x]=w(r.getAttribute(u))),s[u]&&(o[x]=w(s[u])),r.style&&r.style[u]!==""&&(o[x]=w(r.style[u]))}function d(u){return Math.max(0,Math.min(1,b(u)))}function y(u){return Math.max(0,b(u))}return e("fill","fill"),e("fill-opacity","fillOpacity",d),e("fill-rule","fillRule"),e("opacity","opacity",d),e("stroke","stroke"),e("stroke-opacity","strokeOpacity",d),e("stroke-width","strokeWidth",y),e("stroke-linejoin","strokeLineJoin"),e("stroke-linecap","strokeLineCap"),e("stroke-miterlimit","strokeMiterLimit",y),e("visibility","visibility"),o}function P(r,o){return r-(o-r)}function C(r,o,s){if(typeof r!="string")throw new TypeError("Invalid input: "+typeof r);const e={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},d=0,y=1,u=2,x=3;let w=d,T=!0,p="",m="";const M=[];function v(G,ct,dt){const nt=new SyntaxError('Unexpected character "'+G+'" at index '+ct+".");throw nt.partial=dt,nt}function n(){p!==""&&(m===""?M.push(Number(p)):M.push(Number(p)*Math.pow(10,Number(m)))),p="",m=""}let i;const E=r.length;for(let G=0;G<E;G++){if(i=r[G],Array.isArray(o)&&o.includes(M.length%s)&&e.FLAGS.test(i)){w=y,p=i,n();continue}if(w===d){if(e.WHITESPACE.test(i))continue;if(e.DIGIT.test(i)||e.SIGN.test(i)){w=y,p=i;continue}if(e.POINT.test(i)){w=u,p=i;continue}e.COMMA.test(i)&&(T&&v(i,G,M),T=!0)}if(w===y){if(e.DIGIT.test(i)){p+=i;continue}if(e.POINT.test(i)){p+=i,w=u;continue}if(e.EXP.test(i)){w=x;continue}e.SIGN.test(i)&&p.length===1&&e.SIGN.test(p[0])&&v(i,G,M)}if(w===u){if(e.DIGIT.test(i)){p+=i;continue}if(e.EXP.test(i)){w=x;continue}e.POINT.test(i)&&p[p.length-1]==="."&&v(i,G,M)}if(w===x){if(e.DIGIT.test(i)){m+=i;continue}if(e.SIGN.test(i)){if(m===""){m+=i;continue}m.length===1&&e.SIGN.test(m)&&v(i,G,M)}}e.WHITESPACE.test(i)?(n(),w=d,T=!1):e.COMMA.test(i)?(n(),w=d,T=!0):e.SIGN.test(i)?(n(),w=y,p=i):e.POINT.test(i)?(n(),w=u,p=i):v(i,G,M)}return n(),M}const k=["mm","cm","in","pt","pc","px"],V={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function b(r){let o="px";if(typeof r=="string"||r instanceof String)for(let e=0,d=k.length;e<d;e++){const y=k[e];if(r.endsWith(y)){o=y,r=r.substring(0,r.length-y.length);break}}let s;return o==="px"&&a.defaultUnit!=="px"?s=V.in[a.defaultUnit]/a.defaultDPI:(s=V[o][a.defaultUnit],s<0&&(s=V[o].in*a.defaultDPI)),s*parseFloat(r)}function A(r){if(!(r.hasAttribute("transform")||r.nodeName==="use"&&(r.hasAttribute("x")||r.hasAttribute("y"))))return null;const o=L(r);return q.length>0&&o.premultiply(q[q.length-1]),ut.copy(o),q.push(o),o}function L(r){const o=new _t,s=rt;if(r.nodeName==="use"&&(r.hasAttribute("x")||r.hasAttribute("y"))){const e=b(r.getAttribute("x")),d=b(r.getAttribute("y"));o.translate(e,d)}if(r.hasAttribute("transform")){const e=r.getAttribute("transform").split(")");for(let d=e.length-1;d>=0;d--){const y=e[d].trim();if(y==="")continue;const u=y.indexOf("("),x=y.length;if(u>0&&u<x){const w=y.slice(0,u),T=C(y.slice(u+1));switch(s.identity(),w){case"translate":if(T.length>=1){const p=T[0];let m=0;T.length>=2&&(m=T[1]),s.translate(p,m)}break;case"rotate":if(T.length>=1){let p=0,m=0,M=0;p=T[0]*Math.PI/180,T.length>=3&&(m=T[1],M=T[2]),et.makeTranslation(-m,-M),O.makeRotation(p),g.multiplyMatrices(O,et),et.makeTranslation(m,M),s.multiplyMatrices(et,g)}break;case"scale":if(T.length>=1){const p=T[0];let m=p;T.length>=2&&(m=T[1]),s.scale(p,m)}break;case"skewX":T.length===1&&s.set(1,Math.tan(T[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":T.length===1&&s.set(1,0,0,Math.tan(T[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":T.length===6&&s.set(T[0],T[2],T[4],T[1],T[3],T[5],0,0,1);break}}o.premultiply(s)}}return o}function j(r,o){function s(u){$.set(u.x,u.y,1).applyMatrix3(o),u.set($.x,$.y)}function e(u){const x=u.xRadius,w=u.yRadius,T=Math.cos(u.aRotation),p=Math.sin(u.aRotation),m=new it(x*T,x*p,0),M=new it(-w*p,w*T,0),v=m.applyMatrix3(o),n=M.applyMatrix3(o),i=rt.set(v.x,n.x,0,v.y,n.y,0,0,0,1),E=et.copy(i).invert(),dt=O.copy(E).transpose().multiply(E).elements,nt=at(dt[0],dt[1],dt[4]),mt=Math.sqrt(nt.rt1),Ot=Math.sqrt(nt.rt2);if(u.xRadius=1/mt,u.yRadius=1/Ot,u.aRotation=Math.atan2(nt.sn,nt.cs),!((u.aEndAngle-u.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const Nt=et.set(mt,0,0,0,Ot,0,0,0,1),Zt=O.set(nt.cs,nt.sn,0,-nt.sn,nt.cs,0,0,0,1),jt=Nt.multiply(Zt).multiply(i),ee=se=>{const{x:ge,y:ye}=new it(Math.cos(se),Math.sin(se),0).applyMatrix3(jt);return Math.atan2(ye,ge)};u.aStartAngle=ee(u.aStartAngle),u.aEndAngle=ee(u.aEndAngle),F(o)&&(u.aClockwise=!u.aClockwise)}}function d(u){const x=H(o),w=Z(o);u.xRadius*=x,u.yRadius*=w;const T=x>Number.EPSILON?Math.atan2(o.elements[1],o.elements[0]):Math.atan2(-o.elements[3],o.elements[4]);u.aRotation+=T,F(o)&&(u.aStartAngle*=-1,u.aEndAngle*=-1,u.aClockwise=!u.aClockwise)}const y=r.subPaths;for(let u=0,x=y.length;u<x;u++){const T=y[u].curves;for(let p=0;p<T.length;p++){const m=T[p];m.isLineCurve?(s(m.v1),s(m.v2)):m.isCubicBezierCurve?(s(m.v0),s(m.v1),s(m.v2),s(m.v3)):m.isQuadraticBezierCurve?(s(m.v0),s(m.v1),s(m.v2)):m.isEllipseCurve&&(ot.set(m.aX,m.aY),s(ot),m.aX=ot.x,m.aY=ot.y,z(o)?e(m):d(m))}}}function F(r){const o=r.elements;return o[0]*o[4]-o[1]*o[3]<0}function z(r){const o=r.elements,s=o[0]*o[3]+o[1]*o[4];if(s===0)return!1;const e=H(r),d=Z(r);return Math.abs(s/(e*d))>Number.EPSILON}function H(r){const o=r.elements;return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Z(r){const o=r.elements;return Math.sqrt(o[3]*o[3]+o[4]*o[4])}function at(r,o,s){let e,d,y,u,x;const w=r+s,T=r-s,p=Math.sqrt(T*T+4*o*o);return w>0?(e=.5*(w+p),x=1/e,d=r*x*s-o*x*o):w<0?d=.5*(w-p):(e=.5*p,d=-.5*p),T>0?y=T+p:y=T-p,Math.abs(y)>2*Math.abs(o)?(x=-2*o/y,u=1/Math.sqrt(1+x*x),y=x*u):Math.abs(o)===0?(y=1,u=0):(x=-.5*y/o,y=1/Math.sqrt(1+x*x),u=x*y),T>0&&(x=y,y=-u,u=x),{rt1:e,rt2:d,cs:y,sn:u}}const D=[],J={},q=[],rt=new _t,et=new _t,O=new _t,g=new _t,ot=new R,$=new it,ut=new _t,gt=new DOMParser().parseFromString(t,"image/svg+xml");return c(gt.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:D,xml:gt.documentElement}}static createShapes(t){const c={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},h={loc:c.ORIGIN,t:0};function l(P,C,k,V){const b=P.x,A=C.x,L=k.x,j=V.x,F=P.y,z=C.y,H=k.y,Z=V.y,at=(j-L)*(F-H)-(Z-H)*(b-L),D=(A-b)*(F-H)-(z-F)*(b-L),J=(Z-H)*(A-b)-(j-L)*(z-F),q=at/J,rt=D/J;if(J===0&&at!==0||q<=0||q>=1||rt<0||rt>1)return null;if(at===0&&J===0){for(let et=0;et<2;et++)if(_(et===0?k:V,P,C),h.loc==c.ORIGIN){const O=et===0?k:V;return{x:O.x,y:O.y,t:h.t}}else if(h.loc==c.BETWEEN){const O=+(b+h.t*(A-b)).toPrecision(10),g=+(F+h.t*(z-F)).toPrecision(10);return{x:O,y:g,t:h.t}}return null}else{for(let g=0;g<2;g++)if(_(g===0?k:V,P,C),h.loc==c.ORIGIN){const ot=g===0?k:V;return{x:ot.x,y:ot.y,t:h.t}}const et=+(b+q*(A-b)).toPrecision(10),O=+(F+q*(z-F)).toPrecision(10);return{x:et,y:O,t:q}}}function _(P,C,k){const V=k.x-C.x,b=k.y-C.y,A=P.x-C.x,L=P.y-C.y,j=V*L-A*b;if(P.x===C.x&&P.y===C.y){h.loc=c.ORIGIN,h.t=0;return}if(P.x===k.x&&P.y===k.y){h.loc=c.DESTINATION,h.t=1;return}if(j<-Number.EPSILON){h.loc=c.LEFT;return}if(j>Number.EPSILON){h.loc=c.RIGHT;return}if(V*A<0||b*L<0){h.loc=c.BEHIND;return}if(Math.sqrt(V*V+b*b)<Math.sqrt(A*A+L*L)){h.loc=c.BEYOND;return}let F;V!==0?F=A/V:F=L/b,h.loc=c.BETWEEN,h.t=F}function U(P,C){const k=[],V=[];for(let b=1;b<P.length;b++){const A=P[b-1],L=P[b];for(let j=1;j<C.length;j++){const F=C[j-1],z=C[j],H=l(A,L,F,z);H!==null&&k.find(Z=>Z.t<=H.t+Number.EPSILON&&Z.t>=H.t-Number.EPSILON)===void 0&&(k.push(H),V.push(new R(H.x,H.y)))}}return V}function N(P,C,k){const V=new R;C.getCenter(V);const b=[];return k.forEach(A=>{A.boundingBox.containsPoint(V)&&U(P,A.points).forEach(j=>{b.push({identifier:A.identifier,isCW:A.isCW,point:j})})}),b.sort((A,L)=>A.point.x-L.point.x),b}function X(P,C,k,V,b){(b==null||b==="")&&(b="nonzero");const A=new R;P.boundingBox.getCenter(A);const L=[new R(k,A.y),new R(V,A.y)],j=N(L,P.boundingBox,C);j.sort((D,J)=>D.point.x-J.point.x);const F=[],z=[];j.forEach(D=>{D.identifier===P.identifier?F.push(D):z.push(D)});const H=F[0].point.x,Z=[];let at=0;for(;at<z.length&&z[at].point.x<H;)Z.length>0&&Z[Z.length-1]===z[at].identifier?Z.pop():Z.push(z[at].identifier),at++;if(Z.push(P.identifier),b==="evenodd"){const D=Z.length%2===0,J=Z[Z.length-2];return{identifier:P.identifier,isHole:D,for:J}}else if(b==="nonzero"){let D=!0,J=null,q=null;for(let rt=0;rt<Z.length;rt++){const et=Z[rt];D?(q=C[et].isCW,D=!1,J=et):q!==C[et].isCW&&(q=C[et].isCW,D=!0)}return{identifier:P.identifier,isHole:D,for:J}}else console.warn('fill-rule: "'+b+'" is currently not implemented.')}let tt=999999999,I=-999999999,B=t.subPaths.map(P=>{const C=P.getPoints();let k=-999999999,V=999999999,b=-999999999,A=999999999;for(let L=0;L<C.length;L++){const j=C[L];j.y>k&&(k=j.y),j.y<V&&(V=j.y),j.x>b&&(b=j.x),j.x<A&&(A=j.x)}return I<=b&&(I=b+1),tt>=A&&(tt=A-1),{curves:P.curves,points:C,isCW:De.isClockWise(C),identifier:-1,boundingBox:new Re(new R(A,V),new R(b,k))}});B=B.filter(P=>P.points.length>1);for(let P=0;P<B.length;P++)B[P].identifier=P;const ht=B.map(P=>X(P,B,tt,I,t.userData?t.userData.style.fillRule:void 0)),Q=[];return B.forEach(P=>{if(!ht[P.identifier].isHole){const k=new ke;k.curves=P.curves,ht.filter(b=>b.isHole&&b.for===P.identifier).forEach(b=>{const A=B[b.identifier],L=new qt;L.curves=A.curves,k.holes.push(L)}),Q.push(k)}}),Q}static getStrokeStyle(t,a,c,h,l){return t=t!==void 0?t:1,a=a!==void 0?a:"#000",c=c!==void 0?c:"miter",h=h!==void 0?h:"butt",l=l!==void 0?l:4,{strokeColor:a,strokeWidth:t,strokeLineJoin:c,strokeLineCap:h,strokeMiterLimit:l}}static pointsToStroke(t,a,c,h){const l=[],_=[],U=[];if($t.pointsToStrokeWithBuffers(t,a,c,h,l,_,U)===0)return null;const N=new le;return N.setAttribute("position",new At(l,3)),N.setAttribute("normal",new At(_,3)),N.setAttribute("uv",new At(U,2)),N}static pointsToStrokeWithBuffers(t,a,c,h,l,_,U,N){const X=new R,tt=new R,I=new R,B=new R,ht=new R,Q=new R,P=new R,C=new R,k=new R,V=new R,b=new R,A=new R,L=new R,j=new R,F=new R,z=new R,H=new R;c=c!==void 0?c:12,h=h!==void 0?h:.001,N=N!==void 0?N:0,t=T(t);const Z=t.length;if(Z<2)return 0;const at=t[0].equals(t[Z-1]);let D,J=t[0],q;const rt=a.strokeWidth/2,et=1/(Z-1);let O=0,g,ot,$,ut,gt=!1,Yt=0,r=N*3,o=N*2;s(t[0],t[1],X).multiplyScalar(rt),C.copy(t[0]).sub(X),k.copy(t[0]).add(X),V.copy(C),b.copy(k);for(let p=1;p<Z;p++){D=t[p],p===Z-1?at?q=t[1]:q=void 0:q=t[p+1];const m=X;if(s(J,D,m),I.copy(m).multiplyScalar(rt),A.copy(D).sub(I),L.copy(D).add(I),g=O+et,ot=!1,q!==void 0){s(D,q,tt),I.copy(tt).multiplyScalar(rt),j.copy(D).sub(I),F.copy(D).add(I),$=!0,I.subVectors(q,J),m.dot(I)<0&&($=!1),p===1&&(gt=$),I.subVectors(q,D),I.normalize();const M=Math.abs(m.dot(I));if(M>Number.EPSILON){const v=rt/M;I.multiplyScalar(-v),B.subVectors(D,J),ht.copy(B).setLength(v).add(I),z.copy(ht).negate();const n=ht.length(),i=B.length();B.divideScalar(i),Q.subVectors(q,D);const E=Q.length();switch(Q.divideScalar(E),B.dot(z)<i&&Q.dot(z)<E&&(ot=!0),H.copy(ht).add(D),z.add(D),ut=!1,ot?$?(F.copy(z),L.copy(z)):(j.copy(z),A.copy(z)):y(),a.strokeLineJoin){case"bevel":u($,ot,g);break;case"round":x($,ot),$?d(D,A,j,g,0):d(D,F,L,g,1);break;case"miter":case"miter-clip":default:const G=rt*a.strokeMiterLimit/n;if(G<1)if(a.strokeLineJoin!=="miter-clip"){u($,ot,g);break}else x($,ot),$?(Q.subVectors(H,A).multiplyScalar(G).add(A),P.subVectors(H,j).multiplyScalar(G).add(j),e(A,g,0),e(Q,g,0),e(D,g,.5),e(D,g,.5),e(Q,g,0),e(P,g,0),e(D,g,.5),e(P,g,0),e(j,g,0)):(Q.subVectors(H,L).multiplyScalar(G).add(L),P.subVectors(H,F).multiplyScalar(G).add(F),e(L,g,1),e(Q,g,1),e(D,g,.5),e(D,g,.5),e(Q,g,1),e(P,g,1),e(D,g,.5),e(P,g,1),e(F,g,1));else ot?($?(e(k,O,1),e(C,O,0),e(H,g,0),e(k,O,1),e(H,g,0),e(z,g,1)):(e(k,O,1),e(C,O,0),e(H,g,1),e(C,O,0),e(z,g,0),e(H,g,1)),$?j.copy(H):F.copy(H)):$?(e(A,g,0),e(H,g,0),e(D,g,.5),e(D,g,.5),e(H,g,0),e(j,g,0)):(e(L,g,1),e(H,g,1),e(D,g,.5),e(D,g,.5),e(H,g,1),e(F,g,1)),ut=!0;break}}else y()}else y();!at&&p===Z-1&&w(t[0],V,b,$,!0,O),O=g,J=D,C.copy(j),k.copy(F)}if(!at)w(D,A,L,$,!1,g);else if(ot&&l){let p=H,m=z;gt!==$&&(p=z,m=H),$?(ut||gt)&&(m.toArray(l,0*3),m.toArray(l,3*3),ut&&p.toArray(l,1*3)):(ut||!gt)&&(m.toArray(l,1*3),m.toArray(l,3*3),ut&&p.toArray(l,0*3))}return Yt;function s(p,m,M){return M.subVectors(m,p),M.set(-M.y,M.x).normalize()}function e(p,m,M){l&&(l[r]=p.x,l[r+1]=p.y,l[r+2]=0,_&&(_[r]=0,_[r+1]=0,_[r+2]=1),r+=3,U&&(U[o]=m,U[o+1]=M,o+=2)),Yt+=3}function d(p,m,M,v,n){X.copy(m).sub(p).normalize(),tt.copy(M).sub(p).normalize();let i=Math.PI;const E=X.dot(tt);Math.abs(E)<1&&(i=Math.abs(Math.acos(E))),i/=c,I.copy(m);for(let G=0,ct=c-1;G<ct;G++)B.copy(I).rotateAround(p,i),e(I,v,n),e(B,v,n),e(p,v,.5),I.copy(B);e(B,v,n),e(M,v,n),e(p,v,.5)}function y(){e(k,O,1),e(C,O,0),e(A,g,0),e(k,O,1),e(A,g,0),e(L,g,1)}function u(p,m,M){m?p?(e(k,O,1),e(C,O,0),e(A,g,0),e(k,O,1),e(A,g,0),e(z,g,1),e(A,M,0),e(j,M,0),e(z,M,.5)):(e(k,O,1),e(C,O,0),e(L,g,1),e(C,O,0),e(z,g,0),e(L,g,1),e(L,M,1),e(z,M,0),e(F,M,1)):p?(e(A,M,0),e(j,M,0),e(D,M,.5)):(e(L,M,1),e(F,M,0),e(D,M,.5))}function x(p,m){m&&(p?(e(k,O,1),e(C,O,0),e(A,g,0),e(k,O,1),e(A,g,0),e(z,g,1),e(A,O,0),e(D,g,.5),e(z,g,1),e(D,g,.5),e(j,O,0),e(z,g,1)):(e(k,O,1),e(C,O,0),e(L,g,1),e(C,O,0),e(z,g,0),e(L,g,1),e(L,O,1),e(z,g,0),e(D,g,.5),e(D,g,.5),e(z,g,0),e(F,O,1)))}function w(p,m,M,v,n,i){switch(a.strokeLineCap){case"round":n?d(p,M,m,i,.5):d(p,m,M,i,.5);break;case"square":if(n)X.subVectors(m,p),tt.set(X.y,-X.x),I.addVectors(X,tt).add(p),B.subVectors(tt,X).add(p),v?(I.toArray(l,1*3),B.toArray(l,0*3),B.toArray(l,3*3)):(I.toArray(l,1*3),U[3*2+1]===1?B.toArray(l,3*3):I.toArray(l,3*3),B.toArray(l,0*3));else{X.subVectors(M,p),tt.set(X.y,-X.x),I.addVectors(X,tt).add(p),B.subVectors(tt,X).add(p);const E=l.length;v?(I.toArray(l,E-1*3),B.toArray(l,E-2*3),B.toArray(l,E-4*3)):(B.toArray(l,E-2*3),I.toArray(l,E-1*3),B.toArray(l,E-4*3))}break}}function T(p){let m=!1;for(let v=1,n=p.length-1;v<n;v++)if(p[v].distanceTo(p[v+1])<h){m=!0;break}if(!m)return p;const M=[];M.push(p[0]);for(let v=1,n=p.length-1;v<n;v++)p[v].distanceTo(p[v+1])>=h&&M.push(p[v]);return M.push(p[p.length-1]),M}}}const zt={min:.01,max:.15,speed:.5},is={speed:.01},Bt={min:1.1,max:2.5,speed:.3},Ht={min:12,max:30,speed:-.2},S={a:Math.floor(Math.random()*10)+1,b:Math.floor(Math.random()*10)+1,c:1,delta:Math.PI/2,A:16,B:17,C:10,tubeRadius:.2,radialSegments:8,color:12844803,pixelSize:40,bloomStrength:1.5,bloomRadius:.4,bloomThreshold:0,exposure:1,backgroundColor:0,grainAmount:.3,grainSpeed:.2,animateValues:!0,cameraDistance:15},xt=new K.Scene,bt=new K.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3);bt.position.z=S.cameraDistance;const ft=new K.WebGLRenderer({antialias:!0});ft.toneMapping=K.ACESFilmicToneMapping;ft.toneMappingExposure=S.exposure;ft.setSize(window.innerWidth,window.innerHeight);ft.domElement.style.position="absolute";ft.domElement.style.top="0";document.body.appendChild(ft.domElement);const os=`<svg width="100%" height="100%" viewBox="0 0 349 121" xmlns="http://www.w3.org/2000/svg">

<clipPath id="svgTextPath">
<path d="M166.492 0.152327H130.998L128.251 0.840872C125.656 1.55462 123.273 2.88884 121.306 4.7283C119.338 6.56777 117.845 8.85767 116.953 11.4026C111.305 26.7094 105.58 41.4807 99.9318 56.5579C92.2987 77.5283 84.6655 98.4218 76.4218 119.392V120.387H103.901C104.194 120.432 104.493 120.362 104.735 120.191C104.977 120.02 105.143 119.76 105.199 119.469L128.098 58.2415C128.158 57.9564 128.278 57.6874 128.449 57.452C128.62 57.2166 128.839 57.0201 129.092 56.8756C129.344 56.731 129.624 56.6424 129.913 56.614C130.202 56.5856 130.494 56.6185 130.769 56.7111C131.032 56.8184 131.269 56.9786 131.467 57.182C131.665 57.3854 131.819 57.6272 131.919 57.893C132.019 58.1587 132.064 58.4425 132.05 58.7263C132.036 59.0101 131.964 59.2883 131.838 59.5429C129.93 64.6707 128.021 69.7219 126.19 74.8497C122.602 84.3399 119.091 93.83 115.579 103.397C115.554 103.702 115.554 104.01 115.579 104.315L120.236 103.856L156.187 100.106C156.975 99.9435 157.796 100.091 158.478 100.518C159.16 100.946 159.652 101.62 159.851 102.402C161.988 108.295 164.126 114.189 166.187 120.158C166.187 120.847 166.721 121 167.408 121H179.239V17.8322C179.315 14.6554 178.717 11.4982 177.484 8.57089C176.706 6.22359 175.242 4.16509 173.281 2.6636C171.321 1.16212 168.956 0.28735 166.492 0.152327Z" fill="#ffffff"></path>
<path d="M262.058 65.054C261.59 63.6282 260.76 62.3496 259.649 61.3431C258.538 60.3367 257.185 59.6371 255.723 59.3139C253.847 58.9336 251.897 59.2328 250.22 60.1576C248.543 61.0824 247.248 62.5733 246.563 64.3654C246.029 65.6665 245.571 66.9678 245.037 68.3454C244.502 69.723 243.434 70.4115 242.289 69.9523C241.144 69.4931 240.686 68.3449 241.22 66.8907L257.479 23.1901C258.371 20.9895 258.787 18.6234 258.699 16.2495C258.61 13.8755 258.02 11.5478 256.966 9.42009C255.912 7.2924 254.419 5.41422 252.586 3.90892C250.753 2.40362 248.622 1.30535 246.334 0.688545C245.342 0.688545 244.35 0.229602 243.281 0H197.483L194.048 0.688545C190.533 1.61174 187.428 3.68911 185.229 6.58836C183.029 9.48761 181.861 13.0423 181.911 16.6848V120.159H206.337C206.61 120.204 206.889 120.141 207.117 119.984C207.345 119.827 207.503 119.588 207.558 119.316C215.14 98.9073 222.773 78.4982 230.457 58.0891V57.4772C230.542 57.2224 230.678 56.9876 230.857 56.7868C231.035 56.586 231.252 56.4238 231.494 56.3094C231.737 56.1949 232 56.1303 232.268 56.1207C232.536 56.111 232.803 56.1558 233.053 56.2524C233.309 56.3447 233.545 56.4891 233.743 56.6765C233.942 56.864 234.1 57.0904 234.207 57.3417C234.315 57.5931 234.369 57.8642 234.367 58.1377C234.366 58.4112 234.308 58.6818 234.198 58.9318L228.931 72.9372C225.42 82.4275 221.909 91.8408 218.474 101.254C218.308 101.57 218.179 101.904 218.092 102.249L223.282 101.714L239.159 100.031L248.548 98.959C249.489 98.7277 250.483 98.8793 251.313 99.3813C252.143 99.8833 252.74 100.695 252.975 101.638L259.387 119.699C259.387 120.235 259.387 120.465 260.379 120.465H285.11L284.652 119.47L262.058 65.054Z" fill="#ffffff"></path>
<path d="M89.5509 55.7931H70.239C69.9384 55.769 69.6396 55.857 69.4 56.0407C69.1604 56.2244 68.9971 56.4908 68.9415 56.7881L53.0646 100.03C52.454 101.714 51.4617 102.326 50.2404 101.867C49.0191 101.408 48.7139 100.412 49.4009 98.652L64.667 57.4766C65.1846 55.8782 66.2123 54.495 67.5919 53.5406C68.9714 52.5862 70.6261 52.1141 72.3001 52.1962H78.8644C79.7563 52.3003 80.6561 52.0789 81.3989 51.5731C82.1416 51.0672 82.678 50.3098 82.9102 49.4402C86.1924 40.7153 89.4744 31.9144 92.6803 23.1895C93.5893 20.692 93.8927 18.0137 93.5655 15.3754C93.2382 12.7371 92.29 10.2145 90.7986 8.01627C89.3072 5.81806 87.3153 4.0072 84.9881 2.73306C82.6608 1.45891 80.0648 0.757535 77.4141 0.687977C65.3539 0.687977 53.2173 0.687977 41.157 0.687977C37.7379 0.650561 34.391 1.6757 31.5756 3.62154C28.7603 5.56737 26.6145 8.33886 25.4329 11.5562C17.291 32.8326 9.17447 54.1344 1.08341 75.4619C-0.361137 79.0987 -0.361137 83.1521 1.08341 86.7888L9.55601 109.749C10.6775 113.054 12.8231 115.913 15.6791 117.91C18.5352 119.906 21.9525 120.935 25.4329 120.847H70.4683C70.7704 120.894 71.079 120.826 71.3334 120.656C71.5878 120.486 71.7693 120.226 71.8421 119.929C79.0172 100.566 86.1925 81.6611 93.4439 61.9153C94.101 61.3364 94.5298 60.5414 94.6528 59.673C94.7759 58.8047 94.585 57.921 94.1148 57.1814C93.6445 56.4418 92.9261 55.8954 92.0891 55.6408C91.252 55.3862 90.3517 55.4401 89.5509 55.7931Z" fill="#ffffff"></path>
<path d="M323.81 94.2139C321.825 94.2139 320.909 92.9126 321.596 91.0758L339.076 44.0071C341.824 36.3537 344.648 29.3891 347.167 21.9653C347.885 19.7757 348.143 17.461 347.924 15.1667C347.705 12.8724 347.014 10.6487 345.895 8.63531C344.776 6.62194 343.254 4.86286 341.423 3.46889C339.593 2.07491 337.494 1.0765 335.26 0.536262L332.588 0H331.672C331.061 1.91335 330.374 3.75002 329.687 5.58684C322.054 26.4041 314.421 47.1451 306.788 67.9623C306.821 68.1136 306.821 68.2707 306.788 68.422C306.733 68.7063 306.618 68.9748 306.449 69.2096C306.28 69.4443 306.061 69.6398 305.809 69.7813C305.558 69.9229 305.278 70.0069 304.99 70.0289C304.702 70.0509 304.413 70.01 304.143 69.9084C303.872 69.8067 303.627 69.6467 303.425 69.4403C303.222 69.2339 303.067 68.9862 302.97 68.7135C302.873 68.4407 302.837 68.1497 302.863 67.8614C302.89 67.5731 302.979 67.2942 303.124 67.044C304.956 61.9162 306.941 56.7884 308.849 51.7371C315.108 34.7976 321.393 17.9091 327.703 1.07159V0.0766089H279.92C276.889 0.40804 274.015 1.59953 271.635 3.51093C269.256 5.42233 267.469 7.97462 266.485 10.8682C264.806 15.2306 263.203 19.6695 261.524 24.1084C260.302 27.3994 258.852 30.7664 257.86 34.1339C256.756 38.3156 257.133 42.7521 258.929 46.6856C262.974 56.6351 267.172 66.508 271.294 76.3809L287.476 115.108C288.092 116.623 289.151 117.917 290.513 118.818C291.875 119.72 293.478 120.187 295.109 120.159H348.541V93.9841H347.549L323.81 94.2139Z" fill="#ffffff"></path>
</clipPath>
</svg>`,ns=new $t,as=ns.parse(os),kt=new K.Group;as.paths.forEach(f=>{f.toShapes(!0).forEach(a=>{const c=new K.ShapeGeometry(a),h=new K.MeshPhysicalMaterial({color:f.color,metalness:0,roughness:.8,transmission:.9,thickness:1,ior:1.5,transparent:!0,opacity:.7,envMapIntensity:1,clearcoat:1,clearcoatRoughness:.75}),l=new K.Mesh(c,h);kt.add(l)})});const rs=new K.PMREMGenerator(ft);xt.environment=rs.fromScene(new K.Scene).texture;const ls=new K.Box3().setFromObject(kt),hs=ls.getCenter(new K.Vector3);kt.position.sub(hs);kt.scale.set(.05,-.05,.05);kt.position.set(-9,3,0);const cs=new K.AmbientLight(4210752,1);xt.add(cs);const fe=new K.DirectionalLight(16777215,1);fe.position.set(10,10,10);xt.add(fe);const Vt=new Ne(bt,ft.domElement);xt.background=new K.Color(S.backgroundColor);const de=[];for(let f=0;f<=2*Math.PI;f+=.01){const t=S.A*Math.sin(S.a*f+S.delta),a=S.B*Math.sin(S.b*f),c=S.C*Math.sin(S.c*f);de.push(new K.Vector3(t,a,c))}const us=new K.CatmullRomCurve3(de),fs=new K.TubeGeometry(us,400,S.tubeRadius,S.radialSegments,!1),pe=new K.MeshPhongMaterial({color:S.color,side:K.DoubleSide}),Dt=new K.Mesh(fs,pe);xt.add(Dt);function pt(){const f=[];for(let a=0;a<=2*Math.PI;a+=.01){const c=S.A*Math.sin(S.a*a+S.delta),h=S.B*Math.sin(S.b*a),l=S.C*Math.sin(S.c*a);f.push(new K.Vector3(c,h,l))}const t=new K.CatmullRomCurve3(f);Dt.geometry.dispose(),Dt.geometry=new K.TubeGeometry(t,400,S.tubeRadius,S.radialSegments,!1),pe.color.setHex(S.color)}const ds={uniforms:{tDiffuse:{value:null},resolution:{value:new K.Vector2},pixelSize:{value:S.pixelSize}},vertexShader:`
							varying vec2 vUv;
							void main() {
									vUv = uv;
									gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
							}
					`,fragmentShader:`
							uniform sampler2D tDiffuse;
							uniform vec2 resolution;
							uniform float pixelSize;

							varying vec2 vUv;

							void main() {
									vec2 dxy = pixelSize / resolution;
									vec2 coord = dxy * floor(vUv / dxy);
									gl_FragColor = texture2D(tDiffuse, coord);
							}
					`},Pt=new $e(ft),ps=new ts(xt,bt);Pt.addPass(ps);const Lt=new Jt(ds);Lt.uniforms.resolution.value.set(window.innerWidth,window.innerHeight);Pt.addPass(Lt);const vt=new St(new K.Vector2(window.innerWidth,window.innerHeight),S.bloomStrength,S.bloomRadius,S.bloomThreshold);Pt.addPass(vt);const ms={uniforms:{tDiffuse:{value:null},amount:{value:.08},speed:{value:1},time:{value:0}},vertexShader:`
varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,fragmentShader:`
uniform sampler2D tDiffuse;
uniform float amount;
uniform float speed;
uniform float time;
varying vec2 vUv;

float random(vec2 co) {
	return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

void main() {
	vec4 color = texture2D(tDiffuse, vUv);
	vec2 uvRandom = vUv;
	uvRandom.y *= random(vec2(uvRandom.y, time * speed));
	color.rgb += amount * (random(uvRandom) - 0.5);
	gl_FragColor = color;
}
`},Et=new Jt(ms);Pt.addPass(Et);Et.uniforms.amount.value=S.grainAmount;Et.uniforms.speed.value=S.grainSpeed;const gs=document.querySelector(".bodyreal");let Y;Y=new Ie;const It=Y.domElement;It.style.zIndex="9999";It.style.position="fixed";It.style.top="50px";It.style.right="0px";gs.appendChild(Y.domElement);Y.add(S,"a",1,10,1).onChange(pt);Y.add(S,"b",1,10,1).onChange(pt);Y.add(S,"c",1,10,1).onChange(pt);Y.add(S,"A",1,20).onChange(pt);Y.add(S,"B",1,20).onChange(pt);Y.add(S,"C",1,20).onChange(pt);const ys=Y.add(S,"tubeRadius",.01,.8).step(.005).onChange(pt);Y.add(S,"radialSegments",3,20,1).onChange(pt);Y.addColor(S,"color").onChange(pt);Y.add(S,"pixelSize",1,50).onChange(function(f){Lt.uniforms.pixelSize.value=f}).name("Pixel Size");Y.add(S,"bloomStrength",0,3).onChange(function(f){vt.strength=f}).name("Bloom Strength");Y.add(S,"bloomRadius",0,1).onChange(function(f){vt.radius=f}).name("Bloom Radius");Y.add(S,"bloomThreshold",0,1).onChange(function(f){vt.threshold=f}).name("Bloom Threshold");Y.add(S,"exposure",.1,2).onChange(function(f){ft.toneMappingExposure=f}).name("Exposure");Y.addColor(S,"backgroundColor").onChange(function(f){xt.background.set(f)}).name("BG Color");Y.add(S,"grainAmount",0,.5).onChange(function(f){Et.uniforms.amount.value=f}).name("Grain Amount");Y.add(S,"grainSpeed",0,5).onChange(function(f){Et.uniforms.speed.value=f}).name("Grain Speed");Y.add(S,"cameraDistance",5,50).onChange(f=>{bt.position.z=f}).name("Camera Zoom");Y.add(S,"animateValues").name("Animate Values?");function bs(){ys.setValue(S.tubeRadius)}function xs(){if(Y){const f=Object.values(Y.__controllers).find(t=>t.property==="color");f&&f.updateDisplay()}}function _s(){if(Y){const f=Object.values(Y.__controllers).find(t=>t.property==="bloomStrength");f&&f.updateDisplay()}}function Cs(){if(Y){const f=Object.values(Y.__controllers).find(t=>t.property==="cameraDistance");f&&f.updateDisplay()}}window.addEventListener("resize",()=>{ft.setSize(window.innerWidth,window.innerHeight),bt.aspect=window.innerWidth/window.innerHeight,bt.updateProjectionMatrix(),Lt.uniforms.resolution.value.set(window.innerWidth,window.innerHeight),vt.setSize(window.innerWidth,window.innerHeight),Pt.setSize(window.innerWidth,window.innerHeight)});window.location.search.includes("dev")||(It.style.display="none",Vt.enabled=!1,Vt.enableZoom=!1,Vt.enableRotate=!1,Vt.enablePan=!1);window.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded");let f=Math.min(42,Math.floor(window.innerWidth/22));S.pixelSize=f,Lt.uniforms.pixelSize.value=f},!1);let Ct=0;function me(){if(requestAnimationFrame(me),Ct+=.01,Et.uniforms.time.value=Ct,S.animateValues){S.tubeRadius=zt.min+(Math.sin(Ct*zt.speed)+1)*.5*(zt.max-zt.min),bs();const f=Ct*is.speed%1,t=new K.Color;t.setHSL(f,1,.5),S.color=t.getHex(),xs(),S.bloomStrength=Bt.min+(Math.sin(Ct*Bt.speed)+1)*.5*(Bt.max-Bt.min),vt.strength=S.bloomStrength,_s(),S.cameraDistance=Ht.min+(Math.sin((Ct+4)*Ht.speed)+1)*.5*(Ht.max-Ht.min),bt.position.z=S.cameraDistance,Cs()}pt(),Dt.rotation.x+=.005,Dt.rotation.y+=.01,Pt.render()}me();
